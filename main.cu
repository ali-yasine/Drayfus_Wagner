#include <assert.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>

#include "DrayfusWagner.h"
#include "timer.h"
#include "common.h"
#include "Coo.h"
void verify(unsigned int * DP, unsigned int * DP_d, unsigned int num_nodes, unsigned int num_subsets, unsigned int* allSubsets, unsigned int numberOfTerminals){

  for(unsigned int v = 0; v < num_nodes; ++v) {
    for (unsigned int subset = 0; subset < num_subsets; ++subset) {
      if (DP[v * num_subsets + subset] != DP_d[v * num_subsets + subset]) {
        printf("mismatch at vertex v: %u,subset: %u DP: %u\tDP_d: %u\n", v, subset, DP[v * num_subsets + subset], DP_d[v * num_subsets + subset]);
      }
    }
  }
}

void verifyFlippedDP(unsigned int* DP, unsigned int* Dp_d, unsigned int num_nodes, unsigned int num_subsets) {
  for(unsigned int v = 0; v < num_nodes; ++v) {
    for (unsigned int subset = 0; subset < num_subsets; ++subset) {
      if (DP[v * num_subsets + subset] != Dp_d[subset * num_nodes + v]) {
        printf("mismatch at vertex v: %u\t, subset: %u \tDP: %u\tDP_d_opt1: %u\n", v, subset, DP[v * num_subsets + subset], Dp_d[subset * num_nodes + v]);
      }
    }
  } 
}

int main(int argc, char** argv) {
  cudaDeviceSynchronize();
  setbuf(stdout, NULL);
  

  //Testing on a graph of 10 vertices
  // const char* filename = "data/10.txt";

  // CsrGraph* graph = readCSRgraph(filename);


  // unsigned int numberOfTerminals = 5;
  // unsigned int terminals[] = {2,3,5,7,9};
  
  //Testing on a graph of 400 vertices
//   unsigned int numberOfTerminals = 5;
//   unsigned int terminals[] = {2,3,5,7,9};
//   unsigned int numberOfVertices = 400;
//   unsigned int values[] {79, 342, 362, 91, 252, 128, 130, 293, 116, 92, 140, 185, 155, 348, 350, 74, 150, 110, 239, 358, 369, 66, 174, 187, 227, 168, 128, 86, 79, 183, 28, 334, 352, 355, 77, 158, 337, 397, 133, 95, 150, 153, 53, 107, 204, 41, 240, 126, 219, 144, 190, 86, 96, 110, 382, 124, 252, 296, 56, 55, 269, 192, 217, 159, 351, 256, 372, 382, 300, 217, 70, 383, 193, 60, 343, 83, 277, 145, 55, 103, 357, 283, 42, 330, 379, 243, 105, 43, 287, 238, 167, 10, 286, 183, 178, 390, 65, 281, 193, 198, 242, 232, 174, 304, 158, 117, 24, 75, 25, 224, 306, 33, 124, 79, 79, 379, 105, 238, 74, 131, 87, 226, 285, 183, 212, 159, 180, 360, 55, 207, 188, 362, 53, 80, 139, 229, 139, 190, 265, 285, 143, 227, 393, 152, 296, 110, 5, 377, 41, 95, 220, 250, 207, 216, 381, 228, 21, 110, 72, 390, 248, 70, 69, 218, 219, 227, 356, 228, 255, 292, 383, 351, 67, 251, 314, 111, 179, 168, 362, 116, 285, 95, 383, 379, 9, 208, 45, 28, 56, 110, 214, 60, 265, 367, 232, 44, 380, 128, 33, 280, 312, 379, 71, 91, 101, 129, 270, 80, 138, 177, 127, 212, 208, 136, 122, 241, 9, 82, 85, 258, 211, 348, 312, 214, 55, 10, 12, 351, 13, 19, 154, 234, 398, 182, 220, 334, 31, 146, 104, 347, 217, 261, 238, 262, 181, 29, 254, 256, 288, 271, 286, 214, 125, 67, 261, 29, 102, 175, 386, 94, 96, 301, 83, 81, 392, 125, 266, 103, 186, 328, 300, 119, 185, 223, 212, 100, 196, 351, 119, 388, 111, 127, 380, 269, 183, 212, 5, 60, 12, 353, 77, 102, 82, 323, 11, 166, 361, 256, 114, 396, 126, 38, 387, 187, 273, 205, 57, 300, 396, 46, 20, 102, 127, 299, 323, 342, 377, 351, 125, 297, 42, 349, 247, 320, 350, 1, 146, 107, 374, 302, 311, 336, 7, 87, 86, 98, 106, 235, 182, 378, 347, 207, 244, 67, 259, 282, 292, 44, 306, 158, 173, 201, 134, 137, 168, 228, 271, 381, 331, 112, 89, 345, 326, 293, 252, 178, 171, 180, 293, 287, 347, 388, 27, 375, 298, 334, 353, 389, 14, 32, 371, 104, 171, 171, 388, 220, 14, 139, 61, 186, 392, 239, 372, 272, 157, 180, 291, 311, 207, 229, 271, 121, 148, 371, 369, 270, 397, 371, 201, 118, 175, 192, 159, 265, 261, 186, 59, 125, 301, 147, 127, 49, 131, 390, 329, 321, 75, 163, 300, 262, 326, 110, 369, 161, 49, 252, 197, 392, 49, 258, 329, 367, 217, 41, 13, 259, 389, 253, 153, 254, 172, 396, 41, 312, 297, 196, 243, 29, 181, 149, 379, 114, 26, 391, 235, 77, 11, 30, 178, 95, 29, 77, 186, 28, 239, 182, 132, 101, 21, 357, 29, 233, 229, 23, 281, 69, 16, 93, 68, 88, 255, 329, 61, 94, 102, 14, 344, 373, 145, 124, 44, 293, 350, 106, 84, 52, 171, 2, 114, 262, 339, 4, 265, 274, 230, 118, 263, 12, 366, 159, 390, 367, 19, 28, 248, 140, 180, 176, 318, 183, 59, 264, 22, 187, 271, 92, 140, 322, 34, 43, 45, 251, 195, 210, 137, 399, 137, 321, 250, 62, 354, 138, 299, 311, 24, 52, 42, 170, 177, 354, 362, 65, 102, 82, 297, 282, 59, 253, 239, 248, 172, 24, 285, 224, 320, 251, 126, 213, 201, 333, 219, 59, 26, 274, 395, 117, 122, 144, 82, 187, 251, 395, 281, 316, 148, 210, 387, 288, 115, 281, 220, 232, 42, 125, 182, 344, 140, 172, 197, 109, 221, 356, 159, 251, 340, 252, 341, 341, 326, 236, 161, 258, 83, 105, 297, 285, 210, 25, 322, 303, 250, 292, 153, 180, 24, 26, 262, 328, 245, 374, 248, 73, 395, 189, 249, 332, 48, 214, 371, 144, 205, 120, 71, 39, 191, 207, 154, 175, 349, 301, 185, 37, 235, 161, 356, 158, 23, 252, 72, 80, 319, 241, 105, 353, 350, 307, 166, 182, 153, 118, 368, 176, 98, 345, 319, 57, 100, 214, 360, 248, 330, 375, 148, 102, 59, 199, 310, 83, 145, 43, 188, 108, 141, 352, 351, 180, 44, 254, 209, 55, 233, 134, 160, 17, 280, 142, 136, 166, 277, 316, 377, 284, 354, 136, 309, 214, 14, 91, 193, 360, 216, 380, 386, 247, 44, 373, 285, 185, 223, 91, 128, 381, 181, 153, 345, 261, 320, 29, 297, 91, 333, 185, 379, 227, 166, 362, 392, 290, 262, 252, 234, 32, 224, 223, 202, 319, 17, 163, 320, 148, 27, 367, 65, 387, 133, 198, 175, 94, 165, 241, 223, 355, 323, 320, 147, 172, 209, 186, 314, 1, 87, 276, 319, 51, 64, 300, 16, 124, 70, 10, 326, 260, 39, 133, 268, 395, 381, 128, 398, 11, 306, 371, 127, 37, 98, 229, 172, 353, 160, 20, 123, 59, 34, 216, 199, 254, 387, 84, 80, 138, 76, 274, 264, 237, 256, 198, 55, 228, 94, 158, 318, 320, 197, 202, 303, 312, 191, 293, 382, 217, 145, 364, 4, 101, 147, 103, 396, 202, 34, 112, 112, 210, 322, 94, 117, 3, 182, 43, 230, 242, 21, 182, 96, 166, 173, 183, 109, 91, 260, 46, 204, 314, 206, 389, 399, 108, 253, 397, 141, 265, 275, 137, 76, 12, 26, 241, 151, 111, 75, 242, 372, 104, 145, 251, 221, 345, 229, 216, 221, 36, 282, 392, 117, 301, 101, 322, 228, 361, 130, 59, 147, 156, 136, 11, 348, 399, 280, 331, 369, 330, 263, 33, 301, 171, 319, 216, 33, 65, 373, 335, 259, 384, 256, 347, 87, 133, 63, 367, 269, 14, 325, 172, 387, 53, 107, 165, 255, 288, 128, 382, 201, 124, 59, 55, 128, 186, 303, 260, 264, 260, 397, 309, 220, 212, 293, 334, 11, 88, 274, 118, 126, 381, 8, 273, 51, 89, 122, 101, 273, 69, 254, 117, 130, 110, 361, 396, 132, 126, 17, 312, 46, 221, 99, 198, 9, 290, 188, 107, 300, 108, 387, 337, 36, 130, 219, 244, 78, 184, 112, 312, 244, 101, 348, 77, 280, 83, 350, 171, 264, 319, 33, 46, 253, 375, 311, 11, 276, 285, 320, 297, 256, 21, 150, 81, 32, 342, 52, 118, 70, 188, 138, 392, 293, 232, 72, 312, 81, 134, 388, 101, 44, 26, 57, 233, 191, 204, 36, 65, 274, 222, 204, 148, 296, 65, 331, 213, 24, 84, 160, 100, 51, 43, 226, 174, 390, 379, 392, 220, 49, 381, 314, 264, 376, 218, 219, 249, 51, 82, 46, 6, 53, 176, 98, 80, 65, 118, 353, 319, 116, 304, 207, 125, 1, 131, 41, 22, 356, 262, 314, 172, 373, 260, 99, 29, 383, 372, 333, 68, 30, 347, 340, 262, 127, 334, 252, 216, 115, 62, 74, 163, 367, 191, 158, 300, 188, 248, 266, 146, 137, 293, 213, 328, 353, 293, 282, 46, 29, 263, 354, 367, 105, 192, 69, 228, 201, 208, 150, 65, 96, 330, 151, 158, 70, 220, 103, 14, 187, 159, 245, 1, 392, 335, 198, 376, 383, 335, 149, 142, 385, 347, 84, 63, 93, 114, 70, 164, 212, 168, 390, 201, 251, 235, 181, 382, 218, 352, 249, 143, 195, 128, 17, 328, 124, 28, 355, 287, 264, 110, 71, 289, 337, 117, 256, 312, 333, 160, 397, 219, 372, 236, 331, 328, 151, 136, 213, 357, 117, 294, 119, 227, 333, 179, 236, 88, 216, 346, 295, 222, 58, 217, 114, 219, 340, 100, 153, 217, 117, 249, 236, 174, 272, 201, 125, 302, 327, 16, 386, 359, 74, 149, 120, 272, 139, 334, 362, 69, 228, 139, 350, 345, 163, 87, 259, 309, 333, 263, 335, 174, 366, 243, 66, 229, 314, 167, 264, 143, 250, 33, 282, 1, 225, 60, 388, 76, 328, 40, 92, 397, 218, 61, 21, 161, 261, 20, 301, 384, 9, 341, 131, 161, 346, 203, 266, 54, 307, 141, 70, 219, 71, 374, 320, 256, 331, 366, 104, 389, 203, 318, 176, 214, 105, 15, 121, 354, 238, 102, 148, 7, 52, 29, 57, 349, 133, 107, 271, 329, 106, 248, 356, 320, 276, 347, 149, 352, 328, 109, 136, 71, 78, 169, 216, 64, 301, 115, 150, 95, 186, 396, 374, 186, 321, 297, 59, 73, 148, 206, 101, 87, 220, 354, 272, 380, 309, 113, 150, 106, 29, 127, 55, 201, 156, 389, 25, 354, 39, 271, 140, 53, 227, 302, 381, 392, 395, 27, 319, 274, 367, 341, 104, 239, 188, 239, 271, 41, 340, 78, 302, 129, 246, 392, 166, 343, 179, 143, 128, 361, 383, 80, 91, 126, 331, 75, 252, 134, 123, 145, 212, 290, 253, 151, 389, 109, 380, 85, 61, 57, 392, 139, 161, 211, 154, 369, 145, 318, 190, 199, 130, 193, 139, 101, 334, 38, 311, 112, 163, 357, 271, 341, 189, 214, 389, 375, 222, 201, 239, 388, 334, 7, 6, 216, 108, 134, 122, 116, 298, 218, 297, 270, 60, 356, 129, 336, 239, 29, 399, 293, 188, 311, 136, 203, 279, 66, 202, 265, 9, 124, 260, 371, 33, 180, 150, 379, 111, 244, 35, 192, 181, 309, 343, 270, 328, 387, 92, 341, 249, 364, 133, 11, 243, 318, 188, 344, 350, 92, 48, 171, 24, 317, 363, 105, 125, 107, 157, 206, 291, 178, 154, 78, 228, 300, 187, 7, 372, 84, 26, 332, 360, 160, 367, 204, 142, 213, 239, 85, 279, 279, 62, 189, 143, 204, 47, 166, 203, 321, 328, 301, 118, 52, 185, 150, 229, 255, 119, 196, 274, 248, 17, 65, 4, 63, 334, 276, 68, 357, 125, 66, 136, 279, 279, 100, 205, 318, 1, 319, 256, 322, 122, 288, 295, 275, 67, 234, 71, 123, 24, 273, 155, 292, 80, 52, 140, 395, 158, 59, 108, 117, 229, 61, 344, 279, 222, 72, 145, 189, 119, 316, 251, 74, 151, 124, 140, 328, 158, 153, 139, 383, 138, 31, 273, 171, 322, 117, 330, 387, 51, 101, 322, 367, 107, 105, 314, 62, 157, 216, 95, 93, 6, 396, 5, 67, 34, 180, 321, 129, 214, 122, 351, 177, 146, 122, 29, 34, 147, 253, 385, 249, 294, 131, 71, 309, 57, 66, 222, 157, 160, 280, 23, 106, 19, 277, 150, 172, 389, 237, 348, 53, 190, 67, 185, 205, 89, 243, 233, 326, 397, 300, 148, 119, 161, 176, 113, 392, 350, 100, 72, 216, 230, 388, 155, 288, 68, 368, 353, 158, 148, 267, 294, 324, 223, 272, 34, 144, 48, 375, 103, 108, 51, 347, 302, 167, 214, 139, 189, 205, 336, 262, 150, 319, 246, 307, 92, 220, 347, 231, 230, 144, 37, 180, 268, 251, 57, 87, 345, 2, 43, 23, 64, 11, 82, 192, 150, 77, 339, 329, 157, 314, 292, 357, 27, 14, 331, 388, 83, 24, 104, 326, 157, 29, 45, 280, 216, 141, 88, 387, 285, 46, 69, 264, 78, 106, 95, 160, 357, 58, 148, 92, 311, 261, 390, 358, 107, 277, 265, 127, 180, 300, 229, 251, 236, 297, 199, 396, 274, 337, 30, 143, 227, 105, 202, 145, 77, 392, 61, 234, 292, 287, 122, 22, 59, 397, 140, 340, 8, 208, 325, 350, 77, 285, 347, 291, 181, 23, 82, 148, 142, 91, 133, 300, 254, 269, 118, 320, 347, 333, 15, 271, 92, 143, 230, 392, 222, 338, 50, 121, 80, 297, 362, 177, 40, 298, 283, 286, 216, 350, 204, 212, 217, 311, 114, 195, 126, 340, 84, 195, 327, 388, 61, 76, 239, 3, 239, 55, 374, 87, 266, 126, 31, 182, 167, 160, 74, 262, 149, 210, 187, 214, 102, 333, 198, 228, 14, 36, 297, 16, 29, 41, 318, 339, 76, 229, 8, 332, 202, 118, 194, 93, 24, 17, 107, 231, 299, 150, 145, 208, 212, 86, 281, 262, 161, 371, 136, 185, 381, 130, 296, 6, 143, 388, 48, 1, 329, 229, 302, 132, 364, 326, 80, 336, 366, 170, 71, 357, 223, 238, 318, 110, 41, 55, 143, 314, 326, 252, 59, 166, 16, 219, 256, 65, 386, 340, 161, 93, 336, 157, 357, 234, 242, 301, 395, 9, 240, 294, 291, 189, 136, 72, 103, 75, 300, 98, 207, 379, 339, 175, 265, 361, 244, 21, 128, 179, 250, 211, 265, 189, 292, 100, 95, 107, 78, 373, 315, 391, 132, 239, 25, 114, 4, 137, 72, 199, 277, 202, 130, 17, 236, 33, 121, 78, 287, 222, 239, 8, 35, 30, 275, 119, 39, 3, 54, 327, 148, 258, 240, 227, 261, 100, 69, 265, 399, 34, 275, 325, 169, 334, 171, 319, 119, 280, 155, 262, 314, 338, 3, 208, 157, 13, 61, 386, 299, 136, 238, 196, 106, 293, 229, 110, 258, 316, 379, 137, 59, 8, 331, 63, 302, 24, 256, 316, 288, 332, 302, 276, 171, 111, 338, 299, 37, 46, 217, 21, 262, 396, 235, 274, 251, 273, 78, 93, 354, 127, 7, 6, 23, 150, 292, 239, 202, 100, 208, 148, 332, 156, 233, 174, 340, 395, 256, 7, 238, 105, 111, 46, 182, 271, 137, 395, 80, 124, 387, 112, 76, 147, 150, 228, 282, 346, 238, 55, 129, 6, 58, 118, 132, 242, 35, 148, 157, 271, 280, 266, 96, 257, 224, 179, 122, 252, 369, 26, 16, 230, 321, 319, 310, 227, 84, 12, 81, 53, 88, 102, 9, 396, 106, 319, 50, 55, 364, 30, 276, 321, 200, 391, 62, 6, 295, 126, 357, 168, 241, 93, 118, 83, 144, 241, 112, 172, 213, 262, 328, 216, 1, 216, 124, 317, 204, 322, 19, 68, 357, 121, 326, 301, 275, 157, 306, 212, 220, 335, 373, 382, 167, 272, 278, 283, 306, 351, 20, 378, 121, 205, 105, 80, 210, 387, 51, 32, 114, 359, 201, 246, 363, 47, 122, 5, 368, 246, 122, 80, 395, 306, 233, 78, 58, 266, 108, 219, 42, 362, 178, 148, 161, 263, 281, 83, 184, 342, 176, 148, 64, 260, 105, 166, 288, 353, 27, 297, 95, 171, 332, 271, 298, 130, 151, 394, 16, 280, 378, 32, 102, 358, 116, 9, 181, 119, 371, 250, 316, 70, 138, 322, 26, 53, 52, 98, 124, 74, 7, 156, 371, 125, 251, 307, 148, 374, 107, 157, 111, 280, 233, 249, 144, 286, 171, 285, 317, 369, 144, 33, 171, 391, 105, 145, 166, 94, 76, 156, 201, 216, 33, 107, 203, 277, 87, 80, 78, 13, 321, 298, 270, 339, 4, 15, 190, 124, 285, 29, 369, 62, 362, 165, 10, 94, 80, 92, 92, 194, 119, 156, 212, 130, 249, 274, 347, 392, 199, 92, 183, 124, 278, 66, 102, 49, 354, 120, 377, 136, 118, 208, 28, 346, 392, 157, 321, 295, 74, 67, 220, 336, 9, 233, 377, 106, 321, 13, 241, 174, 79, 393, 95, 254, 127, 180, 270, 252, 138, 43, 284, 326, 11, 70, 127, 355, 149, 225, 203, 301, 108, 180, 275, 150, 22, 39, 174, 266, 220, 78, 151, 144, 274, 126, 69, 187, 225, 369, 18, 350, 330, 79, 383, 256, 293, 397, 68, 299, 148, 354, 392, 241, 107, 89, 112, 24, 334, 60, 134, 34, 59, 362, 93, 366, 240, 340, 58, 270, 110, 273, 378, 237, 50, 287, 86, 379, 379, 82, 347, 287, 311, 136, 290, 260, 165, 122, 252, 150, 120, 266, 166, 154, 150, 328, 172, 177, 170, 294, 200, 347, 172, 83, 304, 204, 134, 312, 324, 187, 96, 388, 347, 371, 197, 12, 353, 348, 101, 84, 65, 216, 369, 379, 151, 158, 397, 24, 71, 291, 395, 96, 266, 286, 261, 333, 110, 222, 110, 379, 388, 201, 392, 235, 399, 273, 312, 160, 65, 206, 389, 40, 266, 338, 256, 391, 392, 377, 126, 87, 357, 243, 85, 77, 24, 297, 151, 280, 100, 115, 70, 287, 388, 52, 145, 122, 67, 148, 311, 298, 3, 299, 62, 335, 394, 199, 172, 261, 87, 346, 210, 49, 273, 18, 245, 288, 350, 199, 105, 258, 27, 49, 88, 366, 285, 71, 188, 111, 188, 164, 343, 318, 301, 140, 283, 126, 7, 373, 69, 110, 83, 346, 356, 182, 368, 382, 105, 238, 9, 375, 210, 117, 75, 331, 62, 295, 272, 76, 54, 115, 179, 234, 14, 261, 286, 17, 357, 108, 171, 339, 333, 210, 369, 192, 248, 282, 124, 43, 74, 299, 118, 52, 387, 309, 274, 369, 264, 139, 307, 29, 389, 190, 111, 71, 180, 340, 54, 61, 257, 16, 92, 106, 187, 273, 304, 49, 276, 252, 208, 111, 207, 255, 3, 255, 74, 96, 110, 222, 25, 199, 116, 118, 123, 124, 237, 267, 347, 390, 31, 223, 382, 321, 110, 273, 369, 169, 356, 197, 287, 211, 258, 39, 350, 39, 288, 51, 141, 57, 150, 244, 291, 24, 231, 8, 216, 182, 189, 13, 225, 378, 18, 192, 218, 258, 265, 238, 131, 298, 210, 307, 133, 182, 242, 138, 43, 118, 71, 58, 328, 130, 298, 140, 321, 230, 331, 208, 167, 327, 386, 167, 280, 204, 245, 356, 248, 169, 291, 288, 329, 11, 42, 25, 166, 268, 244, 349, 354, 143, 218, 35, 52, 129, 144, 388, 358, 107, 136, 373, 148, 37, 378, 285, 183, 237, 288, 218, 334, 227, 348, 271, 175, 30, 170, 322, 182, 43, 330, 69, 101, 163, 289, 192, 178, 328, 325, 46, 6, 32, 317, 241, 369, 134, 258, 87, 152, 312, 329, 177, 191, 153, 108, 262, 241, 264, 263, 348, 226, 353, 367, 330, 334, 39, 128, 297, 181, 350, 315, 258, 217, 295, 272, 50, 357, 276, 356, 52, 168, 226, 45, 141, 237, 254, 151, 40, 270, 309, 37, 77, 238, 72, 391, 238, 102, 4, 124, 18, 312, 222, 182, 282, 265, 334, 52, 144, 164, 128, 285, 127, 61, 288, 118, 214, 395, 230, 117, 191, 212, 271, 154, 214, 294, 180, 160, 231, 318, 299, 21, 278, 287, 350, 291, 144, 86, 167, 214, 380, 323, 244, 367, 94, 354, 115, 303, 368, 14, 223, 392, 319, 361, 78, 273, 158, 122, 324, 268, 299, 132, 105, 15, 278, 350, 324, 199, 368, 197, 164};

// unsigned int col[]  {1, 10, 18, 24, 25, 32, 33, 35, 37, 44, 48, 54, 55, 58, 64, 65, 66, 67, 69, 78, 79, 81, 82, 85, 95, 97, 98, 99, 0, 4, 6, 12, 23, 26, 34, 38, 41, 44, 46, 47, 54, 56, 58, 62, 64, 67, 70, 75, 77, 79, 80, 84, 85, 86, 89, 90, 91, 5, 6, 7, 9, 13, 14, 17, 23, 28, 30, 32, 38, 42, 45, 49, 50, 51, 52, 61, 62, 66, 67, 68, 75, 76, 77, 83, 84, 87, 89, 90, 92, 93, 99, 7, 8, 9, 15, 17, 18, 19, 24, 28, 29, 35, 36, 37, 39, 41, 61, 68, 69, 74, 76, 79, 80, 82, 83, 86, 88, 89, 90, 93, 96, 97, 98, 1, 9, 13, 23, 24, 28, 37, 38, 43, 48, 49, 50, 54, 56, 58, 62, 63, 67, 70, 82, 96, 2, 6, 9, 10, 14, 15, 19, 20, 21, 24, 27, 28, 29, 33, 35, 36, 38, 39, 43, 44, 45, 48, 51, 53, 54, 55, 56, 57, 58, 60, 67, 73, 74, 75, 77, 78, 80, 82, 83, 84, 89, 91, 97, 1, 2, 5, 8, 9, 13, 17, 19, 23, 24, 27, 31, 34, 35, 36, 45, 49, 50, 51, 52, 55, 56, 57, 62, 64, 66, 71, 74, 75, 78, 84, 87, 88, 92, 95, 96, 99, 2, 3, 9, 10, 14, 17, 21, 25, 27, 29, 39, 50, 56, 57, 61, 63, 64, 70, 71, 72, 78, 80, 82, 83, 94, 95, 3, 6, 10, 11, 13, 15, 18, 21, 24, 28, 29, 31, 34, 35, 36, 37, 38, 39, 47, 52, 53, 54, 58, 59, 66, 70, 71, 76, 78, 85, 91, 98, 99, 2, 3, 4, 5, 6, 7, 12, 15, 16, 18, 26, 27, 29, 33, 41, 42, 47, 49, 50, 52, 53, 56, 58, 60, 68, 72, 73, 76, 81, 82, 90, 99, 0, 5, 7, 8, 18, 19, 21, 24, 26, 34, 37, 38, 46, 47, 48, 50, 51, 53, 60, 66, 68, 71, 72, 73, 76, 84, 91, 99, 8, 14, 18, 20, 24, 27, 28, 29, 32, 35, 38, 40, 43, 46, 48, 49, 50, 58, 60, 61, 71, 74, 77, 79, 82, 83, 84, 85, 86, 88, 89, 93, 1, 9, 14, 16, 25, 27, 30, 31, 34, 35, 36, 39, 43, 44, 47, 48, 51, 53, 59, 61, 62, 63, 64, 68, 71, 73, 76, 77, 78, 80, 82, 83, 85, 86, 90, 95, 2, 4, 6, 8, 15, 18, 19, 21, 26, 27, 36, 37, 40, 46, 47, 49, 50, 62, 65, 67, 71, 74, 77, 81, 82, 85, 86, 88, 92, 94, 99, 2, 5, 7, 11, 12, 18, 20, 23, 26, 33, 37, 41, 47, 54, 58, 61, 63, 65, 68, 69, 74, 79, 86, 87, 94, 95, 3, 5, 8, 9, 13, 17, 18, 19, 33, 35, 44, 50, 51, 58, 62, 63, 66, 70, 74, 75, 83, 88, 91, 96, 98, 99, 9, 12, 19, 24, 30, 32, 35, 38, 43, 46, 53, 55, 56, 60, 64, 66, 68, 69, 70, 72, 74, 75, 77, 85, 88, 2, 3, 6, 7, 15, 18, 19, 20, 22, 28, 29, 32, 34, 37, 39, 50, 52, 55, 56, 59, 60, 61, 62, 64, 65, 69, 70, 73, 74, 78, 80, 81, 82, 83, 84, 87, 90, 94, 95, 96, 99, 0, 3, 8, 9, 10, 11, 13, 14, 15, 17, 19, 20, 24, 25, 28, 30, 33, 38, 40, 41, 42, 47, 53, 54, 55, 56, 57, 59, 63, 65, 72, 73, 77, 78, 83, 89, 90, 98, 99, 3, 5, 6, 10, 13, 15, 16, 17, 18, 28, 29, 30, 37, 39, 40, 42, 49, 50, 52, 58, 62, 66, 71, 75, 79, 87, 88, 93, 94, 95, 99, 5, 11, 14, 17, 18, 35, 37, 38, 39, 45, 46, 47, 48, 50, 52, 53, 59, 65, 66, 75, 76, 81, 88, 92, 96, 5, 7, 8, 10, 13, 24, 27, 40, 44, 46, 55, 60, 67, 69, 73, 74, 75, 76, 85, 92, 93, 94, 95, 96, 98, 99, 17, 27, 30, 34, 35, 42, 50, 53, 54, 56, 59, 63, 65, 67, 69, 74, 77, 79, 82, 88, 96, 97, 1, 2, 4, 6, 14, 26, 32, 35, 49, 53, 54, 61, 63, 66, 67, 69, 71, 81, 82, 83, 84, 90, 98, 99, 0, 3, 4, 5, 6, 8, 10, 11, 16, 18, 21, 25, 29, 32, 36, 40, 42, 43, 44, 45, 57, 62, 63, 65, 66, 71, 74, 79, 80, 83, 84, 96, 0, 7, 12, 18, 24, 28, 31, 33, 43, 46, 47, 48, 53, 54, 56, 63, 65, 68, 79, 80, 96, 99, 1, 9, 10, 13, 14, 23, 32, 37, 39, 43, 46, 48, 56, 60, 63, 67, 73, 78, 80, 82, 84, 92, 93, 94, 98, 5, 6, 7, 9, 11, 12, 13, 21, 22, 30, 37, 38, 41, 44, 49, 55, 57, 61, 62, 63, 73, 74, 76, 78, 79, 90, 96, 97, 2, 3, 4, 5, 8, 11, 17, 18, 19, 25, 32, 33, 35, 38, 40, 42, 49, 52, 54, 56, 57, 59, 62, 69, 70, 73, 75, 76, 78, 80, 89, 91, 93, 95, 98, 3, 5, 7, 8, 9, 11, 17, 19, 24, 32, 33, 35, 36, 47, 50, 51, 55, 57, 58, 61, 68, 70, 71, 73, 74, 78, 83, 87, 88, 89, 93, 2, 12, 16, 18, 19, 22, 27, 31, 33, 35, 38, 39, 42, 44, 47, 56, 65, 68, 69, 71, 73, 79, 81, 82, 85, 86, 87, 89, 90, 95, 96, 6, 8, 12, 25, 30, 34, 35, 37, 39, 43, 44, 45, 46, 47, 52, 54, 56, 63, 65, 70, 75, 76, 78, 83, 84, 91, 92, 0, 2, 11, 16, 17, 23, 24, 26, 28, 29, 36, 37, 41, 43, 47, 49, 51, 54, 60, 61, 62, 63, 64, 66, 71, 72, 76, 83, 84, 85, 86, 95, 97, 98, 0, 5, 9, 14, 15, 18, 25, 28, 29, 30, 37, 39, 44, 49, 51, 56, 58, 59, 61, 62, 65, 66, 67, 68, 72, 77, 83, 86, 94, 95, 96, 1, 6, 8, 10, 12, 17, 22, 31, 38, 49, 50, 51, 52, 54, 61, 63, 65, 67, 68, 73, 74, 76, 77, 78, 81, 82, 88, 93, 99, 0, 3, 5, 6, 8, 11, 12, 15, 16, 20, 22, 23, 28, 29, 30, 31, 48, 50, 53, 58, 66, 67, 71, 75, 83, 85, 86, 87, 92, 93, 96, 3, 5, 6, 8, 12, 13, 24, 29, 32, 39, 40, 41, 42, 59, 60, 61, 66, 74, 77, 78, 80, 85, 93, 96, 99, 0, 3, 4, 8, 10, 13, 14, 17, 19, 20, 26, 27, 31, 32, 33, 38, 39, 41, 43, 54, 62, 63, 64, 75, 82, 83, 84, 85, 87, 89, 91, 95, 96, 98, 1, 2, 4, 5, 8, 10, 11, 16, 18, 20, 27, 28, 30, 34, 37, 43, 47, 48, 56, 60, 61, 73, 79, 81, 84, 86, 91, 96, 97, 3, 5, 7, 8, 12, 17, 19, 20, 26, 30, 31, 33, 36, 37, 43, 46, 53, 57, 59, 64, 71, 72, 76, 87, 88, 98, 11, 13, 18, 19, 21, 24, 28, 36, 46, 57, 62, 64, 68, 69, 75, 78, 81, 82, 87, 90, 91, 93, 95, 1, 3, 9, 14, 18, 27, 32, 36, 37, 42, 45, 46, 49, 51, 53, 54, 55, 57, 58, 62, 63, 68, 69, 74, 75, 81, 89, 91, 93, 2, 9, 18, 19, 22, 24, 28, 30, 36, 41, 43, 47, 50, 54, 59, 64, 65, 67, 76, 78, 82, 84, 89, 90, 96, 4, 5, 11, 12, 16, 24, 25, 26, 31, 32, 37, 38, 39, 42, 45, 52, 54, 55, 56, 59, 61, 66, 68, 69, 73, 75, 82, 83, 87, 89, 93, 97, 0, 1, 5, 12, 15, 21, 24, 27, 30, 31, 33, 48, 57, 58, 73, 82, 84, 89, 90, 92, 2, 5, 6, 20, 24, 31, 41, 43, 48, 49, 51, 52, 58, 59, 62, 63, 69, 72, 73, 74, 77, 78, 87, 90, 92, 94, 1, 10, 11, 13, 16, 20, 21, 25, 26, 31, 39, 40, 41, 49, 54, 57, 61, 70, 75, 77, 82, 89, 92, 1, 8, 9, 10, 12, 13, 14, 18, 20, 25, 29, 30, 31, 32, 38, 42, 49, 57, 58, 60, 61, 65, 72, 73, 76, 78, 90, 91, 94, 96, 98, 0, 4, 5, 10, 11, 12, 20, 25, 26, 35, 38, 44, 45, 50, 52, 53, 63, 65, 67, 69, 71, 73, 76, 81, 84, 88, 89, 94, 96, 99, 2, 4, 6, 9, 11, 13, 19, 23, 27, 28, 32, 33, 34, 41, 45, 46, 47, 53, 55, 57, 58, 59, 67, 68, 84, 85, 87, 88, 90, 91, 93, 2, 4, 6, 7, 9, 10, 11, 13, 15, 17, 19, 20, 22, 29, 34, 35, 42, 48, 66, 70, 72, 73, 79, 82, 83, 87, 91, 93, 94, 96, 97, 2, 5, 6, 10, 12, 15, 29, 32, 33, 34, 41, 45, 53, 57, 62, 68, 74, 75, 77, 78, 79, 82, 84, 85, 90, 92, 94, 95, 96, 97, 2, 6, 8, 9, 17, 19, 20, 28, 31, 34, 43, 45, 48, 55, 58, 63, 66, 70, 71, 75, 76, 77, 78, 79, 81, 86, 92, 95, 98, 99, 5, 8, 9, 10, 12, 16, 18, 20, 22, 23, 25, 35, 39, 41, 48, 49, 51, 54, 56, 59, 63, 75, 76, 77, 79, 81, 84, 88, 91, 94, 0, 1, 4, 5, 8, 14, 18, 22, 23, 25, 28, 31, 32, 34, 37, 41, 42, 43, 46, 53, 55, 58, 59, 65, 66, 70, 71, 75, 76, 77, 81, 82, 87, 89, 90, 91, 92, 99, 0, 5, 6, 16, 17, 18, 21, 27, 29, 41, 43, 49, 52, 54, 57, 58, 62, 68, 70, 71, 78, 81, 85, 91, 93, 95, 99, 1, 4, 5, 6, 7, 9, 16, 17, 18, 22, 25, 26, 28, 30, 31, 33, 38, 43, 53, 57, 58, 61, 67, 72, 74, 76, 81, 83, 90, 93, 94, 98, 99, 5, 6, 7, 18, 24, 27, 28, 29, 39, 40, 41, 44, 46, 47, 49, 51, 55, 56, 61, 70, 72, 74, 75, 79, 82, 84, 86, 91, 0, 1, 4, 5, 8, 9, 11, 14, 15, 19, 29, 33, 35, 41, 44, 45, 47, 49, 52, 54, 55, 56, 63, 64, 70, 71, 75, 76, 77, 85, 87, 91, 98, 99, 8, 12, 17, 18, 20, 22, 28, 33, 36, 39, 42, 43, 45, 49, 53, 54, 67, 70, 72, 74, 76, 78, 80, 81, 91, 92, 93, 94, 97, 98, 99, 5, 9, 10, 11, 16, 17, 21, 26, 32, 36, 38, 47, 62, 65, 66, 67, 70, 72, 75, 77, 89, 93, 94, 2, 3, 7, 11, 12, 14, 17, 23, 27, 29, 32, 33, 34, 36, 38, 43, 46, 47, 56, 57, 67, 73, 78, 80, 87, 89, 91, 94, 1, 2, 4, 6, 12, 13, 15, 17, 19, 24, 27, 28, 32, 33, 37, 40, 41, 45, 51, 55, 60, 63, 64, 67, 68, 69, 76, 82, 83, 85, 88, 90, 92, 93, 95, 96, 97, 4, 7, 12, 14, 15, 18, 22, 23, 24, 25, 26, 27, 31, 32, 34, 37, 41, 45, 48, 52, 53, 58, 62, 69, 70, 74, 75, 76, 77, 83, 84, 86, 87, 88, 89, 92, 0, 1, 6, 7, 12, 16, 17, 32, 37, 39, 40, 42, 58, 62, 65, 69, 70, 72, 74, 78, 79, 86, 88, 91, 92, 93, 98, 0, 13, 14, 17, 18, 20, 22, 24, 25, 30, 31, 33, 34, 42, 47, 48, 54, 60, 64, 66, 69, 71, 72, 73, 80, 83, 85, 89, 94, 98, 99, 0, 2, 6, 8, 10, 15, 16, 19, 20, 23, 24, 32, 33, 35, 36, 43, 50, 52, 54, 60, 65, 71, 73, 74, 75, 79, 81, 83, 84, 85, 89, 91, 97, 98, 0, 1, 2, 4, 5, 13, 21, 22, 23, 26, 33, 34, 35, 42, 48, 49, 56, 59, 60, 61, 62, 73, 75, 76, 81, 83, 84, 85, 92, 94, 97, 2, 3, 9, 10, 12, 14, 16, 25, 29, 30, 33, 34, 40, 41, 43, 49, 51, 55, 62, 72, 77, 78, 79, 94, 96, 97, 99, 0, 3, 14, 16, 17, 21, 22, 23, 28, 30, 40, 41, 43, 45, 48, 62, 63, 64, 65, 73, 74, 75, 80, 82, 87, 90, 93, 94, 96, 1, 4, 7, 8, 15, 16, 17, 28, 29, 31, 46, 50, 52, 54, 55, 57, 58, 59, 60, 63, 64, 72, 78, 79, 90, 93, 98, 6, 7, 8, 10, 11, 12, 13, 19, 23, 24, 29, 30, 32, 35, 39, 48, 52, 54, 55, 58, 65, 66, 74, 77, 78, 86, 87, 94, 95, 96, 98, 7, 9, 10, 16, 18, 32, 33, 39, 45, 47, 50, 56, 57, 59, 60, 64, 65, 68, 70, 73, 77, 80, 81, 82, 83, 85, 86, 88, 97, 99, 5, 9, 10, 12, 17, 18, 21, 26, 27, 28, 29, 30, 34, 38, 43, 44, 45, 47, 48, 50, 61, 65, 66, 67, 69, 72, 75, 77, 78, 82, 85, 90, 3, 5, 6, 11, 13, 14, 15, 16, 17, 21, 22, 24, 27, 29, 34, 36, 41, 45, 51, 56, 57, 59, 63, 64, 66, 69, 71, 79, 84, 86, 87, 95, 96, 1, 2, 5, 6, 15, 16, 19, 20, 21, 28, 31, 35, 37, 40, 41, 43, 46, 51, 52, 53, 54, 57, 58, 60, 63, 66, 67, 69, 73, 76, 80, 82, 87, 88, 91, 93, 96, 98, 2, 3, 8, 9, 10, 12, 20, 21, 27, 28, 31, 32, 34, 39, 42, 47, 48, 52, 53, 54, 56, 58, 59, 62, 63, 67, 75, 78, 82, 83, 85, 89, 1, 2, 5, 11, 12, 13, 16, 18, 22, 33, 34, 36, 45, 46, 51, 52, 53, 54, 58, 60, 63, 68, 71, 72, 73, 79, 80, 82, 87, 90, 93, 94, 95, 97, 0, 5, 6, 7, 8, 12, 17, 18, 26, 27, 28, 29, 31, 34, 36, 40, 42, 45, 47, 51, 52, 55, 59, 61, 64, 68, 70, 71, 73, 76, 80, 82, 85, 89, 94, 95, 0, 1, 3, 11, 14, 19, 22, 24, 25, 27, 30, 38, 50, 51, 52, 53, 57, 64, 66, 68, 70, 74, 77, 83, 89, 97, 99, 1, 3, 5, 7, 12, 17, 24, 25, 26, 28, 36, 59, 61, 65, 69, 72, 75, 77, 78, 82, 84, 86, 87, 90, 94, 97, 99, 0, 9, 13, 17, 20, 23, 30, 34, 38, 40, 41, 48, 52, 53, 54, 55, 56, 59, 66, 67, 72, 86, 90, 91, 92, 95, 0, 3, 4, 5, 7, 9, 11, 12, 13, 17, 22, 23, 26, 30, 34, 37, 40, 42, 43, 44, 46, 50, 51, 54, 57, 62, 69, 72, 73, 75, 76, 77, 78, 80, 86, 88, 90, 92, 95, 97, 99, 2, 3, 5, 7, 11, 12, 15, 17, 18, 23, 24, 29, 31, 32, 33, 35, 37, 43, 50, 56, 62, 63, 65, 66, 67, 72, 76, 79, 88, 90, 92, 94, 96, 98, 1, 2, 5, 6, 10, 11, 17, 23, 24, 26, 31, 32, 37, 38, 42, 44, 48, 49, 51, 53, 57, 63, 66, 67, 74, 80, 87, 88, 90, 93, 95, 97, 99, 0, 1, 8, 11, 12, 13, 16, 21, 30, 32, 35, 36, 37, 49, 51, 55, 58, 62, 65, 66, 67, 72, 73, 76, 78, 87, 89, 91, 97, 1, 3, 11, 12, 13, 14, 30, 32, 33, 35, 38, 52, 57, 63, 64, 71, 72, 74, 80, 81, 82, 87, 96, 2, 6, 14, 17, 19, 29, 30, 35, 37, 39, 40, 43, 45, 49, 50, 54, 58, 61, 63, 69, 71, 74, 75, 77, 80, 84, 85, 86, 88, 89, 90, 91, 92, 93, 94, 98, 99, 3, 6, 11, 13, 15, 16, 19, 20, 22, 29, 34, 39, 48, 49, 53, 62, 63, 64, 72, 75, 82, 83, 84, 87, 93, 97, 99, 1, 2, 3, 5, 11, 18, 28, 29, 30, 37, 41, 42, 43, 44, 46, 48, 54, 60, 61, 63, 65, 66, 76, 78, 79, 85, 87, 91, 92, 93, 97, 1, 2, 3, 9, 12, 17, 18, 23, 27, 30, 40, 42, 44, 45, 47, 49, 51, 54, 56, 62, 69, 70, 73, 77, 80, 81, 82, 83, 84, 87, 96, 1, 5, 8, 10, 15, 28, 31, 37, 38, 40, 41, 47, 49, 50, 53, 54, 55, 57, 58, 59, 61, 64, 66, 75, 81, 85, 87, 89, 93, 96, 99, 2, 6, 13, 20, 21, 26, 31, 35, 44, 45, 46, 51, 52, 54, 59, 62, 63, 64, 67, 81, 82, 83, 87, 89, 94, 95, 97, 2, 3, 11, 19, 21, 26, 28, 29, 34, 35, 36, 40, 41, 43, 49, 50, 55, 56, 59, 60, 62, 64, 69, 70, 75, 77, 84, 87, 88, 89, 91, 98, 7, 13, 14, 17, 19, 21, 26, 33, 45, 47, 48, 50, 51, 53, 56, 59, 60, 61, 65, 67, 68, 69, 71, 77, 78, 80, 83, 87, 92, 97, 0, 6, 7, 12, 14, 17, 19, 21, 28, 30, 32, 33, 37, 40, 51, 52, 55, 62, 71, 74, 77, 78, 81, 82, 84, 92, 3, 4, 6, 15, 17, 20, 21, 22, 24, 25, 27, 30, 33, 35, 36, 37, 38, 42, 47, 48, 50, 51, 62, 68, 69, 71, 74, 75, 83, 86, 90, 91, 97, 0, 3, 5, 22, 27, 32, 38, 43, 50, 51, 59, 62, 66, 67, 68, 72, 77, 79, 80, 82, 84, 85, 88, 89, 92, 94, 96, 98, 99, 0, 3, 8, 15, 18, 21, 23, 26, 28, 32, 37, 39, 47, 52, 56, 58, 59, 64, 65, 66, 70, 71, 75, 83, 87, 93, 97, 0, 2, 6, 8, 9, 10, 13, 15, 17, 18, 19, 21, 23, 25, 34, 36, 48, 52, 54, 55, 56, 58, 59, 65, 68, 72, 79, 80, 82, 84, 87, 88, 91, 97};

//   unsigned int rowPtr[]   {0, 28, 57, 91, 123, 144, 187, 224, 250, 283, 315, 343, 375, 411, 442, 468, 494, 519, 560, 599, 630, 655, 681, 703, 727, 759, 781, 806, 834, 869, 900, 931, 958, 992, 1023, 1052, 1083, 1108, 1142, 1171, 1197, 1220, 1249, 1274, 1306, 1326, 1352, 1375, 1406, 1436, 1467, 1498, 1528, 1558, 1588, 1626, 1653, 1686, 1714, 1748, 1779, 1802, 1830, 1867, 1903, 1930, 1961, 1995, 2026, 2053, 2082, 2109, 2140, 2170, 2202, 2235, 2273, 2305, 2339, 2375, 2402, 2429, 2455, 2496, 2530, 2563, 2592, 2615, 2652, 2679, 2710, 2741, 2772, 2799, 2831, 2861, 2887, 2920, 2949, 2976, 3010};

  // Testing on a graph of 20 vertices
  
  unsigned int numberOfVertices = 20;   
  unsigned int values[] =  {29359, 16828, 2996, 14605, 12383, 5448, 11539, 17036, 28704, 4665, 12317, 1843, 30107, 12383, 6730, 15351, 3549, 19955, 13932, 22930, 13932, 2307, 22387, 6271, 15574, 16513, 13291, 4032, 18008, 29359, 5448, 27754, 14946, 6423, 2307, 18763, 27596, 11539, 6730, 22387, 30837, 11021, 24022, 19669, 8282, 15351, 4032, 27754, 26419, 18128, 24649, 17808, 14946, 16828, 18763, 26419, 30304, 17036, 3549, 6271, 30837, 32703, 20486, 14344, 2996, 28704, 22930, 11021, 29315, 12317, 15574, 24022, 18128, 19797, 15282, 19955, 16513, 6423, 29315, 20799, 1843, 13291, 19669, 32703, 20799, 23623, 14605, 4665, 30107, 8282, 24649, 30304, 20486, 19797, 23623, 6039, 18008, 27596, 17808, 14344, 15282, 6039};
  unsigned int col[] =     {7, 12, 14, 18, 3, 7, 9, 13, 14, 18, 15, 17, 18, 1, 9, 10, 13, 16, 5, 14, 4, 8, 9, 13, 15, 16, 17, 10, 19, 0, 1, 10, 11, 16, 5, 12, 19, 1, 3, 5, 13, 14, 15, 17, 18, 3, 6, 7, 12, 15, 18, 19, 7, 0, 8, 10, 18, 1, 3, 5, 9, 17, 18, 19, 0, 1, 4, 9, 16, 2, 5, 9, 10, 18, 19, 3, 5, 7, 14, 17, 2, 5, 9, 13, 16, 18, 0, 1, 2, 9, 10, 12, 13, 15, 17, 19, 6, 8, 10, 13, 15, 18};
  unsigned int rowPtr[] =  {0, 4, 10, 13, 18, 20, 27, 29, 34, 37, 45, 52, 53, 57, 64, 69, 75, 80, 86, 96, 102};
  unsigned int numberOfTerminals = 7;
  unsigned int terminals[] = {0, 1, 2, 3, 4, 5, 6};

  
  CsrGraph _graph {
    numberOfVertices,
    numberOfTerminals,
    rowPtr,
    col,
    values
  };
  CsrGraph* graph = &_graph;
  Timer timer;
  
  startTime(&timer);
  printf("Computing Floyd-Warshall...\n");
  unsigned int* apsp = floydWarshall(*graph);
  stopTime(&timer);
  printElapsedTime(timer, "Floyd-Warshall");
  
  startTime(&timer);
  
  printf("Running CPU version\n");

  unsigned int* cpuResult = DrayfusWagner_cpu(*graph, numberOfTerminals, terminals, apsp);
  
  stopTime(&timer);
  printElapsedTime(timer, "CPU time", CYAN);
  
  printf("Running GPU version\n");
  // startTime(&timer);
  // Allocate GPU memory
  CsrGraph* graph_d = createEmptyCSRGraphOnGPU(graph->num_nodes, graph->num_edges);

  // Copy graph to GPU

  copyCSRGraphToGPU(graph, graph_d);
  cudaDeviceSynchronize();

  unsigned int* DP = (unsigned int*) malloc(sizeof(unsigned int) * graph->num_nodes *  ((1 << numberOfTerminals) - 1) );
  
  
  startTime(&timer);
  DrayfusWagnerGPU(graph, graph_d, numberOfTerminals, terminals, DP, apsp);
  stopTime(&timer);

  printElapsedTime(timer, "GPU total time", CYAN);

  // verify(cpuResult, DP, graph->num_nodes , ((1 << numberOfTerminals) - 1), getSortedSubsets(numberOfTerminals), numberOfTerminals);

  free(DP);

  // CsrGraph* graph_opt1_d = createEmptyCSRGraphOnGPU(graph->num_nodes, graph->num_edges);
  // copyCSRGraphToGPU(graph, graph_opt1_d);
  // cudaDeviceSynchronize();



  // unsigned int* DP_opt1 = (unsigned int*) malloc(sizeof(unsigned int) * graph->num_nodes *  ((1 << numberOfTerminals) - 1) );
  // startTime(&timer);
  // DrayfusWagnerGPU_o1(graph, graph_opt1_d, numberOfTerminals, terminals, DP_opt1, apsp);
  // stopTime(&timer);
  // printElapsedTime(timer, "GPU opt1 time", CYAN);
  // // verifyFlippedDP(cpuResult, DP_opt1, graph->num_nodes, ((1 << numberOfTerminals) - 1));
  
  // free(DP_opt1);
  // free(apsp);
  // free(cpuResult);
}
